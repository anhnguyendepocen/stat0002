<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 2: Graphs (More Than One Variable) • stat0002</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 2: Graphs (More Than One Variable)">
<meta property="og:description" content="stat0002">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stat0002</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/stat0002-ch1a-shuttle-vignette.html">Chapter 1: The Challenger Space Shuttle Disaster</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch1b-stochastic-simulation-vignette.html">Chapter 1: Stochastic Simulation</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2a-descriptive-statistics-vignette.html">Chapter 2: Descriptive Statistics</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (More Than One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2d-box-cox-transformation-vignette.html">Chapter 2: Transformation Of Variable</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5a-discrete-random-variables-vignette.html">Chapter 5: binomial, geometric and Poisson distributions</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5b-continous-random-variables-vignette.html">Chapter 5: uniform, exponential and normal distributions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/stat0002/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="stat0002-ch2c-graphs-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 2: Graphs (More Than One Variable)</h1>
                        <h4 class="author">Paul Northrop</h4>
            
            <h4 class="date">2020-10-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/stat0002/blob/master/vignettes/stat0002-ch2c-graphs-vignette.Rmd"><code>vignettes/stat0002-ch2c-graphs-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>stat0002-ch2c-graphs-vignette.Rmd</code></div>

    </div>

    
    
<p>The main purpose of this vignette is to provide R code to produce graphs that involve more than one variable. We consider two general situations: (i) plotting the values of a continuous variable for different values of a categorical variable (see <a href="#the-oxford-birth-times-data">The Oxford Birth Times data</a>) and (ii) scatter plots of one variable against another (see <a href="#the-2000-us-presidential-election-data">The 2000 US Presidential Election data</a>). The latter feature in Section 2.6 of the <a href="https://moodle.ucl.ac.uk/course/view.php?id=8579&amp;section=3">STAT0002 notes</a>. See also the <a href="stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (one variable)</a>.</p>
<p>The R code used in this vignette are available: <a href="stat0002-ch2b-graphs-vignette.R">stat0002-ch2b-graphs-vignette.R</a>.</p>
<div id="the-oxford-birth-times-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-oxford-birth-times-data" class="anchor"></a>The Oxford Birth Times data</h2>
<p>These data are available in the data frame <code>ox_births</code>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">&gt; library(stat0002)
&gt; birth_times &lt;- ox_births[, "time"]
&gt; day &lt;- ox_births[, "day"]</pre></body></html></div>
<p>To display these data we manipulate them into a matrix that is of the same format as Table 2.1 in the notes. The number of birth times varies between days so we pad the matrix with R’s missing values code <code>NA</code> in order that each column of the matrix has the same number of rows.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">&gt; ox_mat &lt;- matrix(NA, ncol = 7, nrow = 16)
&gt; for (i in 1:7) {
+   day_i_times &lt;- ox_births$time[which(ox_births$day == i)]
+   ox_mat[1:length(day_i_times), i] &lt;- sort(day_i_times)
+   colnames(ox_mat) &lt;- paste("day", 1:7, sep = "")
+ }  
&gt; ox_mat
       day1  day2  day3  day4  day5  day6  day7
 [1,]  2.10  4.00  2.60  1.50  2.50  4.00  2.00
 [2,]  3.40  4.10  3.60  4.70  2.50  4.00  2.70
 [3,]  4.25  5.00  3.60  4.70  3.40  5.25  2.75
 [4,]  5.60  5.50  6.40  7.20  4.20  6.10  3.40
 [5,]  6.40  5.70  6.80  7.25  5.90  6.50  4.20
 [6,]  7.30  6.50  7.50  8.10  6.25  6.90  4.30
 [7,]  8.50  7.25  7.50  8.50  7.30  7.00  4.90
 [8,]  8.75  7.30  8.25  9.20  7.50  8.45  6.25
 [9,]  8.90  7.50  8.50  9.50  7.80  9.25  7.00
[10,]  9.50  8.20 10.40 10.70  8.30 10.10  9.00
[11,]  9.75  8.50 10.75 11.50  8.30 10.20  9.25
[12,] 10.00  9.75 14.25    NA 10.25 12.75 10.70
[13,] 10.40 11.00 14.50    NA 12.90 14.60    NA
[14,] 10.40 11.20    NA    NA 14.30    NA    NA
[15,] 16.00 15.00    NA    NA    NA    NA    NA
[16,] 19.00 16.50    NA    NA    NA    NA    NA</pre></body></html></div>
<p>We have a numeric continuous variable, <code>birth_times</code>, and a categorical variable, <code>day</code>. The following code produces the graphs in the <a href="https://moodle.ucl.ac.uk/course/view.php?id=8579&amp;section=3">STAT0002 lecture slides</a> that contain a plot of birth_times for each day of the week.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">&gt; par(mar = c(4, 4, 0.5, 1))
&gt; xlab &lt;- "time (hours)"
&gt; x_labs &lt;- c(min(birth_times), pretty(birth_times), max(birth_times))
&gt; # top left
&gt; box_plot(birth_times ~ day, col = 8, ylab = xlab, pch = 16, xlab = "day")
&gt; # top right
&gt; box_plot(birth_times ~ day, col = 8, horizontal = TRUE,  axes = FALSE, xlab = xlab, ylab = "day", pch = 16)
&gt; axis(1, at = x_labs, labels = x_labs)
&gt; axis(2, at = 1:7, labels = 1:7, lwd = 0, lty = 0)
&gt; # bottom left
&gt; box_plot(birth_times ~ day, axes = FALSE, ylab = xlab, pch = 16, lty = 1, range = 0, boxcol = "white", staplewex = 0, medlty = "blank", medpch = 16, xlab = "day")
&gt; axis(1, at = 1:7, labels = 1:7, lwd = 0, lty = 0)
&gt; axis(2, at = x_labs, labels = x_labs)
&gt; # bottom right
&gt; box_plot(birth_times ~ day, horizontal = TRUE, axes = FALSE, xlab = xlab, pch = 16, lty = 1, range = 0, boxcol = "white", staplewex = 0, medlty = "blank", medpch = 16)
&gt; axis(1, at = x_labs, labels = x_labs)
&gt; axis(2, at = 1:7, labels = 1:7, lwd = 0, lty = 0, las = 1)</pre></body></html></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-1.png" width="326.4"><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-2.png" width="326.4"><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-3.png" width="326.4"><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-4.png" width="326.4"></p>
</div>
<div id="the-2000-us-presidential-election-in-florida" class="section level2">
<h2 class="hasAnchor">
<a href="#the-2000-us-presidential-election-in-florida" class="anchor"></a>The 2000 US Presidential Election in Florida</h2>
<p>These data are available in the data frame <code>USelection</code>. See <code><a href="../reference/USelection.html">?USelection</a></code> for details.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r">&gt; # County identifiers and location
&gt; head(USelection[, 1:4])
  co co_names  lat  lon
1  1  Alachua 29.7 82.4
2  2    Baker 30.3 82.3
3  3      Bay 30.2 85.6
4  4 Bradford 29.9 82.2
5  5  Brevard 28.3 80.7
6  6  Broward 26.1 80.5
&gt; # County demographic variables
&gt; head(USelection[, 5:12])
     npop whit blac hisp  o65 hsed coll  inco
1  198326 74.4 21.8  4.7  9.4 82.7 34.6 19412
2   20761 82.4 16.8  1.5  7.7 64.1  5.7 14859
3  146223 84.2 12.4  2.4 11.9 74.7 15.7 17838
4   24646 76.1 22.9  2.6 11.8 65.0  8.1 13681
5  460977 88.3  9.2  4.1 16.5 82.3 20.4 19567
6 1470758 80.3 17.5 10.9 20.3 76.8 18.8 24706
&gt; # Numbers of votes for candidates
&gt; head(USelection[, 13:22])
    bush   gore brow nade harr hage buch mcre phil moor
1  34124  47365  658 3226    6   42  263    4   20   21
2   5610   2392   17   53    0    3   73    0    3    3
3  38637  18850  171  828    5   18  248    3   18   27
4   5414   3075   28   84    0    2   65    0    2    3
5 115185  97318  643 4470   11   39  570   11   72   76
6 177323 386561 1212 7101   50  129  788   34   74  124</pre></body></html></div>
<p>For the moment we simply produce some scatter plots. A separate vignette will be devoted to these data.</p>
<p>A plot to show the locations of the counties.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r">&gt; plot(-USelection[, "lon"], USelection[, "lat"], xlab = "longitude (degrees north)", ylab = "latitude (degrees east)", pch = 16)</pre></body></html></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<ol style="list-style-type: decimal">
<li><strong>Can you see the outline of the state of Florida?</strong></li>
</ol>
<p>A plot of the percentage of the vote for Buchanan against population size.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">&gt; pbuch &lt;- 100 * USelection$buch/USelection$tvot
&gt; is_PB &lt;- USelection[, "co_names"] == "PalmBeach"
&gt; pch &lt;- 1 + 3 * is_PB
&gt; pch
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[39] 1 1 1 1 1 1 1 1 1 1 1 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
&gt; plot(USelection$npop, pbuch, xlab = "population", ylab = "Buchanan % vote", pch = pch)
&gt; which_PB &lt;- which(is_PB)
&gt; text(USelection[which_PB, "npop"], pbuch[which_PB] + 0.1, "Palm Beach", cex = 0.8)</pre></body></html></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Can you see how the code used to identify Palm Beach on the plot works?</strong></li>
</ol>
<p>Pairwise scatter plots of the demographic variables.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">&gt; pairs(USelection[, 5:12])</pre></body></html></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>A plot of the square root of the percentage of the vote for Buchanan against population size, in thousands of people. The horizontal axis has been plotted on a log scale.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">&gt; x &lt;- USelection$npop / 1000
&gt; y &lt;- sqrt(pbuch)
&gt; ystring &lt;- expression(sqrt("% Buchanan vote"))
&gt; rm_PB &lt;- which(!is_PB)
&gt; scatter(x[rm_PB], y[rm_PB], pch = 16, xlab ="Total Population (1000s)", ylab = ystring, log = "x")
&gt; points(x[which_PB], y[which_PB], pch = "X")
&gt; text(x[which_PB], y[which_PB] + 0.04, "Palm Beach", cex = 0.8)</pre></body></html></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<ol start="3" style="list-style-type: decimal">
<li><p><strong>Can you see how the different method to identify Palm Beach works?</strong></p></li>
<li><p><strong>Can you guess what the numbers on the axes are? See <code>scatter</code> to find out.</strong></p></li>
</ol>
<p>Similarly, we use <code>scatter_hist</code> to create a scatter plot in which the distribution of each variable is summarized by a histogram.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r">&gt; scatter_hist(x, y, log = "x", pch = 16, xlab ="Total Population (1000s)", ylab = ystring)</pre></body></html></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>The plot in the lecture slides is produced by specifying particular bins for the histograms.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">&gt; logx &lt;- log(x)
&gt; xbreaks &lt;- seq(from = min(logx), to = max(logx), len = 25)
&gt; ybreaks &lt;- seq(from = min(y), to = max(y), len = 25)
&gt; scatter_hist(x, y, log = "x", pch = 16, xlab ="Total Population (1000s)", ylab = ystring, xbreaks = xbreaks, ybreaks = ybreaks)</pre></body></html></div>
<p><img src="stat0002-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
