<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 1: The Challenger Space Shuttle Disaster • stat0002</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 1: The Challenger Space Shuttle Disaster">
<meta property="og:description" content="stat0002">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stat0002</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/stat0002-ch1a-shuttle-vignette.html">Chapter 1: The Challenger Space Shuttle Disaster</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch1b-stochastic-simulation-vignette.html">Chapter 1: Stochastic Simulation</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2a-descriptive-statistics-vignette.html">Chapter 2: Descriptive Statistics</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (More Than One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2d-box-cox-transformation-vignette.html">Chapter 2: Transformation Of Variable</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5a-discrete-random-variables-vignette.html">Chapter 5: binomial, geometric and Poisson distributions</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5b-continous-random-variables-vignette.html">Chapter 5: uniform, exponential and normal distributions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/stat0002/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="stat0002-ch1a-shuttle-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 1: The Challenger Space Shuttle Disaster</h1>
                        <h4 class="author">Paul Northrop</h4>
            
            <h4 class="date">2020-10-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/stat0002/blob/master/vignettes/stat0002-ch1a-shuttle-vignette.Rmd"><code>vignettes/stat0002-ch1a-shuttle-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>stat0002-ch1a-shuttle-vignette.Rmd</code></div>

    </div>

    
    
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<p>This vignette contains ideas and techniques that are not covered until later in STAT0002 and others (stochastic simulation and logistic regression) that are not part of the STAT0002 syllabus. Therefore, you should not worry too much about these details: just try to get a sense of how the R code works. The questions and comments below are there to prompt you to think about things.</p>
<p>For information about R see the <a href="https://moodle.ucl.ac.uk/course/view.php?id=8581">STAT0004 Moodle page</a> (if you are taking STAT1006) or the <a href="https://moodle.ucl.ac.uk/course/view.php?id=10773">Introduction to R Moodle page</a> (if you are not taking STAT1006, e.g. Natural Sciences students).</p>
<p>The R code used in this vignette are available: <a href="stat0002-ch1a-shuttle-vignette.R">shuttle-vignette.R</a>. The functions <code>shuttle_sim</code> and <code>shuttle_sim_plot</code> can be viewed by typing the name of the function at R command prompt <code><a href="https://rdrr.io/r/base/Comparison.html">&gt;</a></code>.</p>
<p>If you have any questions please ask them using the <a href="https://moodle.ucl.ac.uk/mod/hsuforum/view.php?id=866683">STAT0002 discussion forum</a>.</p>
</div>
<div id="the-challenger-space-shuttle-disaster" class="section level2">
<h2 class="hasAnchor">
<a href="#the-challenger-space-shuttle-disaster" class="anchor"></a>The Challenger Space Shuttle Disaster</h2>
<p>In the first lecture we discussed the Challenger Space Shuttle Disaster. In this vignette we are concerned mainly with the R code, so there is very little discussion of the problem, the data or statistical ideas. For discussion of these see the notes and/or lecture slides in the <a href="https://moodle.ucl.ac.uk/course/view.php?id=8579&amp;section=3">Notes</a> section of the STAT0002 Moodle page.</p>
<p>In this vignette we consider how R can be used to analyse data related to this disaster. See <span class="citation">Dalal, Fowlkes, and Hoadley (1989)</span> for more information about these data and analyses to estimate the probability of a catastrophic failure of the Challenger space shuttle under the launch conditions on 28th January 1986. This paper is used as a <a href="https://moodle.ucl.ac.uk/mod/resource/view.php?id=316154">worked example</a> for the <a href="https://moodle.ucl.ac.uk/course/view.php?id=8579&amp;section=4">STAT0002 Meet your Professor ICA</a>.</p>
<p>In the following R commands follow the command prompt <code><a href="https://rdrr.io/r/base/Comparison.html">&gt;</a></code> and <code>#</code> is used to create a comment, that is, to prevent R from trying to execute text that contains comments rather than a command.</p>
<p>First we load the <code>stat0002</code> package.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">&gt; library(stat0002)
Loading required package: rpanel
Loading required package: tcltk
Package `rpanel', version 1.1-4: type help(rpanel) for summary information</pre></body></html></div>
<div id="the-o-ring-data" class="section level3">
<h3 class="hasAnchor">
<a href="#the-o-ring-data" class="anchor"></a>The O-ring data</h3>
<p>The data are available in a <strong>data frame</strong> called <code>shuttle</code>. A data frame is what R calls a table of data. Use <code><a href="../reference/shuttle.html">?shuttle</a></code> to find out about these data.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">&gt; # Print the data to the screen 
&gt; shuttle
   flight       date damaged temperature pressure
1       1 21/04/1981       0          66       50
2       2 12/11/1981       1          70       50
3       3 22/03/1982       0          69       50
4       4 11/11/1982       0          68       50
5       5 04/04/1983       0          67       50
6       6 18/06/1983       0          72       50
7       7 30/08/1983       0          73      100
8       8 28/11/1983       0          70      100
9       9 03/02/1984       1          57      200
10     10 06/04/1984       1          63      200
11     11 30/08/1984       1          70      200
12     12 05/10/1984       0          78      200
13     13 08/11/1984       0          67      200
14     14 24/01/1985       3          53      200
15     15 12/04/1985       0          67      200
16     16 29/04/1985       0          75      200
17     17 17/06/1985       0          70      200
18     18 29/07/1985       0          81      200
19     19 27/08/1985       0          76      200
20     20 03/10/1985       0          79      200
21     21 30/10/1985       2          75      200
22     22 26/11/1986       0          76      200
23     23 21/01/1986       1          58      200
24     24 28/01/1986      NA          31      200</pre></body></html></div>
<ol style="list-style-type: decimal">
<li><strong>What do you think <code>NA</code> means?</strong></li>
</ol>
<div class="sourceCode" id="cb3"><html><body><pre class="r">&gt; # The function head() prints only the first 6 lines of the data (useful to see the structure of large datasets)
&gt; head(shuttle)
  flight       date damaged temperature pressure
1      1 21/04/1981       0          66       50
2      2 12/11/1981       1          70       50
3      3 22/03/1982       0          69       50
4      4 11/11/1982       0          68       50
5      5 04/04/1983       0          67       50
6      6 18/06/1983       0          72       50</pre></body></html></div>
<ol start="2" style="list-style-type: decimal">
<li><strong>Can you guess which R function prints only the last 6 lines of the data?</strong></li>
</ol>
<div class="sourceCode" id="cb4"><html><body><pre class="r">&gt; # Tabulate the number of O-rings with thermal distress
&gt; table(shuttle[, "damaged"])

 0  1  2  3 
16  5  1  1 </pre></body></html></div>
<div class="sourceCode" id="cb5"><html><body><pre class="r">&gt; # Repeat and assign the output to the vector o_ring_table 
&gt; o_ring_table &lt;- table(shuttle[, 3])</pre></body></html></div>
<p><strong>Note the different way to get the column that we want.</strong></p>
<p>We produce a bar plot of the numbers of distressed O-rings and a scatter plot of temperature against pressure. See also the vignette <a href="stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (more than one variable)</a>.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">&gt; barplot(o_ring_table, xlab = "number of distressed O-rings", ylab = "frequency")
&gt; attach(shuttle)
The following object is masked from package:datasets:

    pressure
&gt; plot(pressure, temperature)</pre></body></html></div>
<p><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-7-1.png" width="700"><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Can you see what <code><a href="https://rdrr.io/r/base/attach.html">attach(shuttle)</a></code> enabled us to do? Type <code><a href="https://rdrr.io/r/base/attach.html">?attach</a></code> to find out what the <code><a href="https://rdrr.io/r/base/attach.html">attach()</a></code> function does.</strong></li>
</ol>
<p><strong>Did you also note the warning message? This means that there exists another variable called <code>pressure</code>, in the R package called <code>datasets</code>. [Type <code><a href="https://rdrr.io/r/datasets">library(help = "datasets")</a></code> to see all the datasets available in the <code>datasets</code> package.] Using <code><a href="https://rdrr.io/r/base/attach.html">attach(shuttle)</a></code> means that if we ask R for the variable <code>pressure</code> then R gives us <code>shuttle[, "pressure"]</code>. Otherwise <code>pressure</code> would give us the data in the <code>datasets</code> package. This highlights the fact that if we use <code><a href="https://rdrr.io/r/base/attach.html">attach()</a></code> then we need to be careful.</strong></p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">&gt; # The opposite of the function attach() is the function detach()
&gt; detach(shuttle)</pre></body></html></div>
<div class="sourceCode" id="cb8"><html><body><pre class="r">&gt; pairs(shuttle[, 3:5])</pre></body></html></div>
<p><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Can you work out what the <code>3:5</code> bit is used for and what the <code><a href="https://rdrr.io/r/graphics/pairs.html">pairs()</a></code> function does?</strong></li>
</ol>
<div class="sourceCode" id="cb9"><html><body><pre class="r">&gt; # Remove the zeros from the O-ring damage data
&gt; not_zero &lt;- shuttle$damaged &gt; 0
&gt; not_zero
 [1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE
[13] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE    NA</pre></body></html></div>
<ol start="5" style="list-style-type: decimal">
<li><strong>Can you see what the vector <code>not_zero</code> contains?</strong></li>
</ol>
<div class="sourceCode" id="cb10"><html><body><pre class="r">&gt; xlim &lt;- range(shuttle$temperature)
&gt; xlim
[1] 31 81
&gt; # Plot with no zeros
&gt; plot(shuttle$temperature[not_zero], shuttle$damaged[not_zero], xlim = xlim, ylim = c(0, 3), ann = FALSE)
&gt; title(xlab = "temperature / deg F", ylab = "number of distressed O-rings")
&gt; # Plot of all the data
&gt; plot(shuttle$temperature, shuttle$damaged, ann = FALSE)
&gt; title(xlab = "temperature / deg F", ylab = "number of distressed O-rings")</pre></body></html></div>
<p><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-11-1.png" width="326.4"><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-11-2.png" width="326.4"></p>
<ol start="6" style="list-style-type: decimal">
<li><p><strong>Can you see/guess what the functions <code>range</code> and <code>title</code> and the function arguments <code>xlim</code>, <code>ann</code>, <code>xlab</code> and <code>ylab</code> do?</strong></p></li>
<li><p><strong>Did you see yet another way to refer to the variable <code>temperature</code> in the <code>shuttle</code> dataset?</strong></p></li>
</ol>
</div>
<div id="relating-the-probability-of-o-ring-damage-to-temperature" class="section level3">
<h3 class="hasAnchor">
<a href="#relating-the-probability-of-o-ring-damage-to-temperature" class="anchor"></a>Relating the probability of O-ring damage to temperature</h3>
<p>This section involves a statistical model, a <em>logistic regression model</em>, that is not part of the STAT0002 syllabus, so don’t worry too much about the details that follow. However, this section involves things that we <em>will</em> study later in STAT0002, namely <em>independence</em>, the <em>binomial distribution</em> and (the general concept of) <em>regression</em>. We fit the model using a general fitting method called <em>maximum likelihood estimation</em>. This method is not formally part of the STAT0002 syllabus, but we will look at it very briefly later in the course.</p>
<p>Consider the six O-rings on the space shuttle. We suppose that on a launch at temperature <span class="math inline">\(t\)</span> degrees F:</p>
<ul>
<li>each O-ring has a probability <span class="math inline">\(p(t)\)</span> of suffering thermal distress;</li>
<li>whether or not a given O-ring suffers thermal distress is not affected by whether or not other O-rings suffer thermal distress, that is, the O-rings are independent of each other in this respect.</li>
</ul>
<p>Under these assumptions the number of O-rings that suffer thermal distress has a binomial distribution with parameters <span class="math inline">\(6\)</span> and <span class="math inline">\(p(t)\)</span>. We will study this distribution in Section 5.3 of the <a href="https://moodle.ucl.ac.uk/mod/resource/view.php?id=316139">STAT0002 notes</a>. We have reason to believe that <span class="math inline">\(p(t)\)</span> depends on <span class="math inline">\(t\)</span>, that is, the probability that an O-ring suffers thermal distress is different for different launch temperatures. A simple model that is used in this kind of situation is a <em>linear logistic regression model</em>, in which <span class="math display">\[ \ln \left(\frac{p(t)}{1-p(t)}\right) = \alpha + \beta t, \]</span> for some unknown constants <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. That is, the <em>logit</em> <span class="math inline">\(\log[p(t) / (1-p(t))]\)</span> of <span class="math inline">\(p(t)\)</span> is assumed to be a linear function of <span class="math inline">\(t\)</span>. Inverting this equation gives <span class="math display">\[ p(t) = \frac{e^{\alpha + \beta t}}{1 + e^{\alpha + \beta t}}. \]</span></p>
<ol start="8" style="list-style-type: decimal">
<li><p><strong>Why would it not make sense to suppose that <span class="math inline">\(p(t)\)</span> is a linear function of <span class="math inline">\(t\)</span>? [Bear in mind that <span class="math inline">\(p(t)\)</span> is a probability and therefore can be no smaller than 0 and no larger than 1.]</strong></p></li>
<li><p><strong>How does <span class="math inline">\(p(t)\)</span> behave as <span class="math inline">\(t\)</span> becomes very small, and as <span class="math inline">\(t\)</span> becomes very large, and how does this depend on the value of <span class="math inline">\(\beta\)</span>?</strong></p></li>
<li><p><strong>What happens in the special case where <span class="math inline">\(\beta = 0\)</span>?</strong></p></li>
</ol>
<p>A linear logistic regression model is a special case of a Generalized Linear Model. The function <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> can be used to fit this type of model, using <em>maximum likelihood estimation</em> to estimate the unknown parameters (or <em>coefficients</em>) <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. First we create <em>response</em> data <code>y</code> (numbers of O-rings with and without thermal distress) and the <em>explanatory</em> data <code>x</code> (the launch temperatures).</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">&gt; # Create a matrix y containing 2 columns:
&gt; #   column 1: number of O-rings WITH thermal distress
&gt; #   column 2: number of O-rings WITHOUT thermal distress
&gt; y &lt;- cbind(shuttle[1:23, 3], 6 - shuttle[1:23, 3])
&gt; head(y)
     [,1] [,2]
[1,]    0    6
[2,]    1    5
[3,]    0    6
[4,]    0    6
[5,]    0    6
[6,]    0    6
&gt; x &lt;- shuttle[1:23, 4]
&gt; x
 [1] 66 70 69 68 67 72 73 70 57 63 70 78 67 53 67 75 70 81 76 79 75 76 58</pre></body></html></div>
<p>Then we fit the model.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">&gt; shuttle_fit &lt;- glm(y ~ x, family = binomial)
&gt; # Produce a summary of the estimates.  There is a lot of output: only look at the
&gt; # numbers in the column headed "Estimate".
&gt; summary(shuttle_fit)

Call:
glm(formula = y ~ x, family = binomial)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9876  -0.7798  -0.4987  -0.2975   2.7483  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)  6.75183    2.97989   2.266  0.02346 * 
x           -0.13971    0.04647  -3.007  0.00264 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 28.761  on 22  degrees of freedom
Residual deviance: 19.093  on 21  degrees of freedom
AIC: 36.757

Number of Fisher Scoring iterations: 5
&gt; alpha_hat &lt;- shuttle_fit$coefficients[1]
&gt; beta_hat &lt;- shuttle_fit$coefficients[2]</pre></body></html></div>
<p>We calculate the <em>fitted</em>, or <em>estimated</em> probability <span class="math inline">\(p(t)\)</span> over a range of temperatures that includes 31 degrees F, and stored these numbers in a vector called <code>fitted_probs</code>.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">&gt; temp &lt;- seq(from = 30, to = 85, by = 0.1)
&gt; linear_predictor &lt;- alpha_hat + beta_hat * temp
&gt; fitted_curve &lt;- exp(linear_predictor) / (1 + exp(linear_predictor))</pre></body></html></div>
<ol start="11" style="list-style-type: decimal">
<li><strong>Can you guess what the function <code>seq</code> does? Use <code><a href="https://rdrr.io/r/base/seq.html">?seq</a></code> to find out.</strong></li>
</ol>
<p>We plot the <em>proportions</em> of distressed O-rings against temperature with the fitted logistic probability curve <span class="math inline">\(p(t)\)</span> superimposed. The second plot is the same as the plot in the lecture slides.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r">&gt; plot(shuttle$temperature, shuttle$damaged / 6, ann = FALSE, ylim = c(0, 1))
&gt; title(xlab = "temperature / deg F", ylab = "proportion of distressed O-rings")
&gt; lines(temp, fitted_curve)</pre></body></html></div>
<p><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
<p>Now we produce a better plot, one that is similar to the plot that appears in the lecture slides.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r">&gt; repeated_data &lt;- which(duplicated(shuttle[, 3:4]))
&gt; shuttle[repeated_data, ]
   flight       date damaged temperature pressure
11     11 30/08/1984       1          70      200
13     13 08/11/1984       0          67      200
15     15 12/04/1985       0          67      200
17     17 17/06/1985       0          70      200
22     22 26/11/1986       0          76      200
&gt; new_damaged &lt;- shuttle$damaged
&gt; new_damaged[c(11, 13, 17, 22)] &lt;- new_damaged[c(11, 13, 17, 22)] + 0.2  
&gt; new_damaged[15] &lt;- new_damaged[15] - 0.2  
&gt; plot(shuttle$temperature, new_damaged / 6, ann = FALSE, ylim = c(0, 1), pch = 16)
&gt; title(xlab = "temperature (deg F)", ylab = "proportion of distressed O-rings")
&gt; lines(temp, fitted_curve)
&gt; legend("topright", legend = c("sample proportions", "fitted curve"), pch=c(16, -1), lty = c(-1, 1))
&gt; abline(v = 31, lty = 2)</pre></body></html></div>
<p><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
<ol start="12" style="list-style-type: decimal">
<li><strong>Can you see how the second plot is different from the first plot and identify the bits of the R code that do this? To find our about the many options for changing the appearance of a plot use <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code>.</strong></li>
</ol>
</div>
<div id="using-stochastic-simulation-to-assess-uncertainty" class="section level3">
<h3 class="hasAnchor">
<a href="#using-stochastic-simulation-to-assess-uncertainty" class="anchor"></a>Using stochastic simulation to assess uncertainty</h3>
<p>The smooth curve superimposed on the plot immediately above cannot be thought of as “the truth”: it is merely an estimate <span class="math inline">\(\hat{p}(t)\)</span>, based on a single dataset and some simple modelling assumptions, of how the probability <span class="math inline">\(p(t)\)</span> of O-ring distress might depend on launch temperature <span class="math inline">\(t\)</span>. If the launches were repeated, under exactly the same conditions that produced the original data, then we would (with high probability) obtain a different dataset and hence a different fitted smooth curve. That is, different experiments produce different datasets, which leads to different estimated curves and therefore <em>uncertainty</em> about <span class="math inline">\(p(t)\)</span>.</p>
<p>In reality we are not able to repeat the launches and so we have only one dataset, producing one estimated curve. However, we should appreciate that this dataset (and its estimated curve) is one example taken from a <em>population</em> of datasets (and their respective estimated curves) could be obtained. The size of our uncertainty based on this one dataset is related to how variable is this population of estimated curves. If the estimated curves are very similar then it may not matter which of them we get from our real dataset, because our findings will be similar for all datasets. However, if the estimated curves are very different then our findings will vary a lot depending on which dataset we have obtained.</p>
<p>Although we cannot repeat the launches we can get an idea of how much uncertainty there is about <span class="math inline">\(p(t)\)</span> for given values of <span class="math inline">\(t\)</span> by simulating fake datasets from the model fitted to the real data. This involves getting a computer to `decide’ whether or not a given O-ring suffers thermal distress during a launch at temperature <span class="math inline">\(t\)</span>, in a random manner such that the probability of distress equals <span class="math inline">\(\hat{p}(t)\)</span>. For more details about how we can use a computer to generate <em>pseudo-random numbers</em> (numbers that are close enough to being random for our purposes) see the vignette <a href="stat0002-ch1b-stochastic-simulation-vignette.html">Stochastic simulation</a> and/or the short <a href="https://moodle.ucl.ac.uk/course/view.php?id=8579&amp;section=8">Stochastic simulation video</a>.</p>
<p>The function <code>shuttle_sim</code> simulates fake O-ring thermal distress data for Challenger Space Shuttle launches at different launch temperatures. The following code simulates 10 fake datasets of size 23, using the real launch temperatures.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r">&gt; # Simulate 10 fake datasets of size 23, using the real temperatures.
&gt; res &lt;- shuttle_sim(n_sim = 10)
&gt; res
   temps real sim1 sim2 sim3 sim4 sim5 sim6 sim7 sim8 sim9 sim10
1     66    0    0    0    2    0    0    1    0    2    0     0
2     70    1    0    0    0    0    0    1    0    0    1     0
3     69    0    0    0    0    0    0    0    0    1    0     0
4     68    0    0    0    1    0    0    1    0    0    1     2
5     67    0    2    0    0    0    0    0    0    0    0     0
6     72    0    1    1    0    0    0    0    0    0    0     1
7     73    0    0    0    0    0    0    0    0    1    0     0
8     70    0    1    0    1    0    0    2    0    0    0     2
9     57    1    1    0    1    3    0    3    2    1    4     0
10    63    1    1    1    1    0    0    0    0    2    0     0
11    70    1    0    1    1    0    2    1    0    0    0     0
12    78    0    0    0    1    0    0    0    0    0    0     0
13    67    0    1    0    0    1    0    0    0    1    0     0
14    53    3    1    3    3    0    2    3    2    2    1     1
15    67    0    0    0    1    0    1    0    1    1    0     1
16    75    0    0    0    1    0    0    0    0    0    0     0
17    70    0    2    0    0    1    0    1    1    0    1     0
18    81    0    0    1    0    1    0    0    0    0    0     0
19    76    0    0    0    0    0    0    1    0    0    0     0
20    79    0    0    0    0    0    0    0    0    1    1     0
21    75    2    0    0    0    0    0    0    0    0    0     0
22    76    0    0    1    0    1    0    0    0    1    0     0
23    58    1    2    2    0    1    2    2    2    2    0     2</pre></body></html></div>
<p>This function can also be used to simulate the number of distressed O-rings under the scenario that we launch the space shuttle many times at a single temperature. Here we do this 1000 times at 31 degrees F.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r">&gt; # Simulate the number of distressed O-rings for 1000 launches at 31 deg F.
&gt; res &lt;- shuttle_sim(n_sim = 1000, temperature = 31)
&gt; res[1:100]
  [1] 5 6 5 6 5 6 6 6 6 6 5 6 6 5 4 4 6 6 6 6 5 6 6 6 5 6 6 6 6 5 5 6 5 6 5 5 6
 [38] 5 5 6 5 5 5 6 5 6 4 6 6 6 6 4 5 5 6 4 6 6 5 6 6 6 5 6 5 6 6 6 6 6 5 6 6 5
 [75] 5 6 6 5 5 6 6 6 5 6 5 6 5 6 5 6 5 6 6 6 6 6 5 6 6 6
&gt; table(res)
res
    2     3     4     5     6 
   15   204  1703  7336 13742 </pre></body></html></div>
<p>The function <code>shuttle_sim_plot</code> plots multiple linear logistic curves. Each curve is the result of simulating a fake dataset from the linear logistic model fitted to the real data and then estimating the linear logistic curve using the fake dataset. The following plot also contains the real data and a (blue) curve showing the curve fitted to the real data.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r">&gt; shuttle_sim_plot(n_sim = 50, col = "grey")</pre></body></html></div>
<p><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<p>Given that we are simulating data using a computer we could consider a scenario where 10 launches are carried out at each temperature in the real dataset, i.e. the simulated datasets now have size 23 x 10 = 230, rather than 23. This plot shows how the estimated curves would vary between different simulated datasets.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r">&gt; shuttle_sim_plot(n_sim = 50, n_reps = 10, plot_real_data = FALSE, lty = 1)</pre></body></html></div>
<p><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<p>Now we consider the case where the simulated datasets each have size 2300.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r">&gt; shuttle_sim_plot(n_sim = 50, n_reps = 100, plot_real_data = FALSE, lty = 1)</pre></body></html></div>
<p><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>See also the function <code>shuttle_movie</code> for an animated version of <code>shuttle_sim_plot</code>.</p>
<p>Finally, we produce a plot that is (almost) the same as Figure 1.6 in the notes.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r">&gt; x &lt;- shuttle_sim_plot(n_sim = 1000, plot = FALSE)
Warning: glm.fit: algorithm did not converge
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
&gt; shuttle_sim_hists(x, temps = c(31, 50, 65, 80), col = 8)</pre></body></html></div>
<p><img src="stat0002-ch1a-shuttle-vignette_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script><div id="refs" class="references">
<div id="ref-shuttle">
<p>Dalal, S. R., E. B. Fowlkes, and B. Hoadley. 1989. “Risk Analysis of the Space Shuttle: Pre-Challenger Prediction of Failure.” <em>Journal of the American Statistical Association</em> 84 (408): 945–57. <a href="http://dx.doi.org/10.1080/01621459.1989.10478858">http://dx.doi.org/10.1080/01621459.1989.10478858</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
