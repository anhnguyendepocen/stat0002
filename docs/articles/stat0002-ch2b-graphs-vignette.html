<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 2: Graphs (One Variable) • stat0002</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 2: Graphs (One Variable)">
<meta property="og:description" content="stat0002">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stat0002</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/stat0002-ch1a-shuttle-vignette.html">Chapter 1: The Challenger Space Shuttle Disaster</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch1b-stochastic-simulation-vignette.html">Chapter 1: Stochastic Simulation</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2a-descriptive-statistics-vignette.html">Chapter 2: Descriptive Statistics</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (More Than One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2d-box-cox-transformation-vignette.html">Chapter 2: Transformation Of Variable</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5a-discrete-random-variables-vignette.html">Chapter 5: binomial, geometric and Poisson distributions</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5b-continous-random-variables-vignette.html">Chapter 5: uniform, exponential and normal distributions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/stat0002/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="stat0002-ch2b-graphs-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 2: Graphs (One Variable)</h1>
                        <h4 class="author">Paul Northrop</h4>
            
            <h4 class="date">2020-10-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/stat0002/blob/master/vignettes/stat0002-ch2b-graphs-vignette.Rmd"><code>vignettes/stat0002-ch2b-graphs-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>stat0002-ch2b-graphs-vignette.Rmd</code></div>

    </div>

    
    
<p>The main purpose of this vignette is to provide R code to produce graphs that feature in Chapter 2 of the STAT0002 notes. All these graphs involve one variable only. See also the <a href="stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (more than one variable)</a>.</p>
<p>The R code used in this vignette are available: <a href="stat0002-ch2b-graphs-vignette.R">graphs-vignette.R</a>.</p>
<div id="the-oxford-birth-times-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-oxford-birth-times-data" class="anchor"></a>The Oxford Birth Times data</h2>
<p>These data are available in the data frame <code>ox_births</code>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">&gt; library(stat0002)
&gt; birth_times &lt;- ox_births[, "time"]
&gt; sort(birth_times)
 [1]  1.50  2.00  2.10  2.50  2.50  2.60  2.70  2.75  3.40  3.40  3.40  3.60
[13]  3.60  4.00  4.00  4.00  4.10  4.20  4.20  4.25  4.30  4.70  4.70  4.90
[25]  5.00  5.25  5.50  5.60  5.70  5.90  6.10  6.25  6.25  6.40  6.40  6.50
[37]  6.50  6.80  6.90  7.00  7.00  7.20  7.25  7.25  7.30  7.30  7.30  7.50
[49]  7.50  7.50  7.50  7.80  8.10  8.20  8.25  8.30  8.30  8.45  8.50  8.50
[61]  8.50  8.50  8.75  8.90  9.00  9.20  9.25  9.25  9.50  9.50  9.75  9.75
[73] 10.00 10.10 10.20 10.25 10.40 10.40 10.40 10.70 10.70 10.75 11.00 11.20
[85] 11.50 12.75 12.90 14.25 14.30 14.50 14.60 15.00 16.00 16.50 19.00</pre></body></html></div>
<div id="empirical-cumulative-distribution-function" class="section level3">
<h3 class="hasAnchor">
<a href="#empirical-cumulative-distribution-function" class="anchor"></a>Empirical cumulative distribution function</h3>
<ol style="list-style-type: decimal">
<li><strong>Can you work out from the output below what the function <code>ecdf</code> does? Use <code><a href="https://rdrr.io/r/stats/ecdf.html">?ecdf</a></code> to check our answer.</strong></li>
</ol>
<div class="sourceCode" id="cb2"><html><body><pre class="r">&gt; ox_ecdf &lt;- ecdf(birth_times)
&gt; ox_ecdf(1)
[1] 0
&gt; ox_ecdf(2)
[1] 0.02105263
&gt; 2/95
[1] 0.02105263
&gt; ox_ecdf(4.7)
[1] 0.2421053
&gt; 23/95
[1] 0.2421053
&gt; ox_ecdf(19)
[1] 1
&gt; ox_ecdf(100)
[1] 1</pre></body></html></div>
<p>The <code>plot</code> method for an object returned by <code>ecdf</code> produces a plot much like (the hollow circles in) Figure 2.3 in the STAT0002 notes.</p>
<p>We will label a lot of axes with “time (hours)”. To make our lives a little easier we create a character variable called <code>xlab</code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">&gt; xlab &lt;- "time (hours)"</pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r">&gt; plot(ox_ecdf, main = "", xlab = xlab, ylab = "cumulative relative frequency", pch = 1)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<ol start="2" style="list-style-type: decimal">
<li><strong>It should be obvious what the arguments <code>xlab</code> and <code>ylab</code> do. What do you think that <code>main = ""</code> and <code>pch = 1</code> do? Use <code><a href="https://rdrr.io/r/graphics/title.html">?title</a></code> and <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code> (respectively) to find out more. <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code> lists lots of arguments that can be used to adjust a graph.</strong></li>
</ol>
</div>
<div id="histogram" class="section level3">
<h3 class="hasAnchor">
<a href="#histogram" class="anchor"></a>Histogram</h3>
<p>The following code produces histograms that feature in the STAT0002 notes. Note that in the first plot the <code>probability = TRUE</code> (or <code>prob = TRUE</code> for short) argument is important: it ensures that the total area of the rectangles of the histogram is equal to 1. In the second plot it isn’t necessary to include <code>prob = TRUE</code> because if the bin widths are unequal then (sensibly) <code>hist</code> uses <code>prob = TRUE</code>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r">&gt; hist(birth_times, prob = TRUE, col = 8, main = "", xlab = xlab)
&gt; br &lt;- c(seq(from = 0, to = 12, by = 2), 20)
&gt; hist(birth_times, breaks = br, col = 8, main = "", xlab = xlab)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-6-1.png" width="624"><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-6-2.png" width="624"></p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Can you see what the argument <code>breaks</code> does? … and the function and <code>seq</code>?</strong></li>
</ol>
<p>The <code>hist</code> function returns an object (a <em>list</em> of several objects in fact) containing the information used to construct the plot. If we assign this to an R object, <code>ox_tab</code> say, then we can look at this information and perhaps use it. The <code>ls</code> function tells us the names of the objects in this list. Use <code><a href="https://rdrr.io/r/graphics/hist.html">?hist</a></code> to find out what these objects are.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">&gt; ox_tab &lt;- hist(birth_times, plot = FALSE)
&gt; ls(ox_tab)
[1] "breaks"   "counts"   "density"  "equidist" "mids"     "xname"   </pre></body></html></div>
<p>We use the information in <code>ox_tab</code> to reproduce the plot in Figure 2.2 of the notes.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">&gt; cum_rel_freq &lt;- cumsum(c(0, ox_tab$counts)) / length(birth_times)
&gt; plot(ox_tab$breaks, cum_rel_freq, type = "b", pch = 16, ylab = "cumulative relative frequency", xlab = xlab)
&gt; abline(h = 1, lty = 2)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-8-1.png" width="624"></p>
<ol start="4" style="list-style-type: decimal">
<li><strong>What do you think the function <code>cumsum</code> does?</strong></li>
</ol>
<p>The following code produces histogram-like alternative plots. As you can see we can do many things to change the appearance of plots. Use <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code> to see a list of the graphical parameters that we can use.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">&gt; # adjust plot margins, produce a 2 by 2 array of plots (fill row 1 then row 2)
&gt; par(mar = c(4, 4, 1, 1), mfrow = c(2, 2))
&gt; # no vertical axis
&gt; hist(birth_times, col = 8, prob = TRUE, axes = FALSE, xlab = xlab, ylab = "", main = "")
&gt; axis(1, line = 0.5)
&gt; # no vertical axis plus rug of points
&gt; hist(birth_times, col = 8, prob = TRUE, axes = FALSE, xlab = xlab, ylab = "",main = "")
&gt; axis(1, line = 0.5)
&gt; rug(birth_times, line = 0.5, ticksize = 0.05)
&gt; # non-shaded frequency polygon
&gt; n &lt;- length(ox_tab$mids)
&gt; ox_tab$mids &lt;- c(ox_tab$mids[1], ox_tab$mids, ox_tab$mids[n])
&gt; ox_tab$density &lt;- c(0, ox_tab$density, 0)
&gt; plot(ox_tab$mids, ox_tab$density, xlab = xlab, ylab = "density", type = "l", las = 1) 
&gt; axis(1, line = 0)
&gt; # shaded frequency polygon with no vertical axis
&gt; plot(ox_tab$mids, ox_tab$density, xlab = xlab, ylab = "", type = "l", bty= "l", axes = FALSE)
&gt; axis(1, line = -0.4)
&gt; polygon(ox_tab$mids, ox_tab$density, col = 8)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-9-1.png" width="624"></p>
</div>
<div id="stem-and-leaf-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#stem-and-leaf-plot" class="anchor"></a>Stem-and-leaf plot</h3>
<div class="sourceCode" id="cb9"><html><body><pre class="r">&gt; # The default plot
&gt; stem(birth_times)

  The decimal point is at the |

   0 | 5
   2 | 015567844466
   4 | 00012233779035679
   6 | 1334455890023333355558
   8 | 12333555558902335588
  10 | 0123444778025
  12 | 89
  14 | 33560
  16 | 05
  18 | 0
&gt; 
&gt; # The plot that appears in the notes
&gt; stem(birth_times, scale = 2)

  The decimal point is at the |

   1 | 5
   2 | 0155678
   3 | 44466
   4 | 00012233779
   5 | 035679
   6 | 133445589
   7 | 0023333355558
   8 | 123335555589
   9 | 02335588
  10 | 0123444778
  11 | 025
  12 | 89
  13 | 
  14 | 3356
  15 | 0
  16 | 05
  17 | 
  18 | 
  19 | 0</pre></body></html></div>
<ol start="5" style="list-style-type: decimal">
<li><strong>Use <code><a href="https://rdrr.io/r/graphics/stem.html">?stem</a></code> to see what <code>scale</code> does.</strong></li>
</ol>
</div>
<div id="dotplot" class="section level3">
<h3 class="hasAnchor">
<a href="#dotplot" class="anchor"></a>Dotplot</h3>
<p>It is surprisingly difficult to produce a nice-looking dotplot using standard R functions. One possibility is to use <code>stripchart</code>. The code below also produces the plots Figure 2.5 in the notes.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">&gt; stripchart(birth_times, method = "stack", pch = 16, at = 0, offset = 2/3)
&gt; title(xlab = xlab)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-11-1.png" width="624"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">&gt; x &lt;- round(birth_times)
&gt; stripchart(x, method = "stack", pch = 16, at = 0, axes = FALSE, offset = 2/3)
&gt; title(xlab = xlab)
&gt; x_labs &lt;- c(min(x), pretty(x), max(x))
&gt; axis(1, at = x_labs)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-11-2.png" width="624"></p>
<ol start="6" style="list-style-type: decimal">
<li><strong>Find out what the functions <code>pretty</code> and <code>axis</code> do.</strong></li>
</ol>
</div>
<div id="boxplot" class="section level3">
<h3 class="hasAnchor">
<a href="#boxplot" class="anchor"></a>Boxplot</h3>
<p>The function that produces a boxplot (or <em>box-and-whisker</em> plot) is called <code>boxplot</code>. Inside <code>boxplot</code> the estimation of the quartiles, on which the box part of the plot is based, uses the default value of the argument <code>type</code> (i.e. <code>type = 7</code>) in a call to <code>quantile</code>. In order that we can change the value of <code>type</code> if we wish <code>stat0002</code> contains a function <code>box_plot</code>, which is a copy of <code>boxplot</code> with the extra argument <code>type</code> added. In <code>box_plot</code> the default is <code>type = 6</code>, which corresponds to the particular way of estimating quartiles that is described in the STAT0002 lecture notes and slides. See the <a href="stat0002-ch2a-descriptive-statistics-vignette.html">Descriptive Statistics</a> vignette for more information about <code>quantile</code> and the argument <code>type</code>. In many cases we will not need to worry about the choice of the value of <code>type</code>. Unless the dataset is small the value of <code>type</code> will not have enough of an effect on the appearance of the boxplot to matter. This is certainly the case for the <code>birth_times</code> data.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">&gt; # type = 6
&gt; b1 &lt;- box_plot(birth_times, horizontal = TRUE, main = "type = 6", xlab = xlab)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-12-1.png" width="624"></p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">&gt; # type = 7
&gt; b2 &lt;- boxplot(birth_times, horizontal = TRUE, main = "type = 7")</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-12-2.png" width="624"></p>
<p>We know from the <a href="stat0002-ch2a-descriptive-statistics-vignette.html">Descriptive Statistics</a> vignette that only the estimates of the lower quartile differ between the <code>type = 6</code> and <code>type = 7</code> cases. We can check this using the objects <code>b1</code> and <code>b2</code> returned above.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r">&gt; as.vector(b1$stats)
[1]  1.50  4.90  7.50  9.75 16.50
&gt; as.vector(b2$stats)
[1]  1.50  4.95  7.50  9.75 16.50</pre></body></html></div>
<ol start="7" style="list-style-type: decimal">
<li><strong>Can you work out from the output and graphs above what <code>boxplot</code> returns in the list component <code>stats</code>? Check your answer using <code><a href="https://rdrr.io/r/graphics/boxplot.html">?boxplot</a></code>. How could we obtain the values of any data points that lie outside the whiskers?</strong></li>
</ol>
<p>If we read the documentation of <code>boxplot</code> carefully (see <code><a href="https://rdrr.io/r/graphics/boxplot.html">?boxplot</a></code> and <code><a href="https://rdrr.io/r/graphics/bxp.html">?bxp</a></code>) we can have a lot of control over the graph that it produces. The following code produces the plots in Figure 2.7 of the STAT0002 notes.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r">&gt; par(mar = c(4, 1, 0.5, 1))
&gt; x_labs &lt;- c(min(birth_times), pretty(birth_times), max(birth_times))
&gt; # top left
&gt; box_plot(birth_times, horizontal = TRUE, col = 8, xlab = xlab, pch = 16)
&gt; # top right
&gt; boxplot(birth_times, horizontal = TRUE, col = 8, axes = FALSE, xlab = xlab, pch = 16)
&gt; axis(1, at = x_labs, labels = x_labs)
&gt; # bottom left
&gt; boxplot(birth_times, horizontal = TRUE, axes = FALSE, xlab = xlab, pch = 16, lty = 1, range = 0, staplewex = 0)
&gt; axis(1, at = x_labs, labels = x_labs)
&gt; # bottom right
&gt; boxplot(birth_times, horizontal = TRUE, axes = FALSE, xlab = xlab, pch = 16, lty = 1, range = 0, boxcol = "white", staplewex = 0, medlty = "blank", medpch = 16)
&gt; axis(1, at = x_labs, labels = x_labs)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-14-1.png" width="326.4"><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-14-2.png" width="326.4"><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-14-3.png" width="326.4"><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-14-4.png" width="326.4"></p>
<p>In the <a href="stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (more than one variable)</a> vignette we consider both variables in the <code>ox_births</code> data frame, i.e. the numeric continuous variable <code>time</code> and the categorical variable <code>day</code>, producing separate boxplots of <code>time</code> for each day of the week.</p>
</div>
</div>
<div id="the-challenger-o-ring-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-challenger-o-ring-data" class="anchor"></a>The Challenger O-ring data</h2>
<p>We return to the data that feature in the <a href="stat0002-ch1a-shuttle-vignette.html">Challenger Space Shuttle disaster</a> vignette. The column  in the data frame  contains the observed numbers of O-rings that suffer thermal distress. This is a <em>numerical discrete</em> variable. In fact we can be more precise than this, it is an <em>integer</em> variable. One way to summarize these data graphically is using a bar plot. In order to produce the bar plot we first need to tabulate the data, using the function<code>table</code> to calculate the frequencies of the numbers of distressed O-rings.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r">&gt; shuttle$damaged
 [1]  0  1  0  0  0  0  0  0  1  1  1  0  0  3  0  0  0  0  0  0  2  0  1 NA
&gt; O_tab &lt;- table(shuttle$damaged)
&gt; O_tab

 0  1  2  3 
16  5  1  1 </pre></body></html></div>
<p>This table is OK but it does not include the zero frequencies for the categories 4, 5 and 6.</p>
<ol start="8" style="list-style-type: decimal">
<li><strong>Why can we not expect the output from <code>table</code> not include the categories 4, 5 and 6?</strong></li>
</ol>
<div id="a-digression-table-and-classes-of-r-objects" class="section level3">
<h3 class="hasAnchor">
<a href="#a-digression-table-and-classes-of-r-objects" class="anchor"></a>A digression: <code>table</code> and classes of R objects</h3>
<p>An answer to question 8. is “R can’t possibly know which values the variable <code>shuttle$damaged</code> could have”. It is obvious to us, because we know what these data mean and that a space shuttle has 6 O-rings, but R’s <code>table</code> function cannot infer this from the data alone. In this example it probably doesn’t matter that some of the zero frequencies are missing. However, consider the following example. We simulate 10 values from a Poisson distribution with a mean of 5. For an introduction to simulation see the <a href="stat0002-ch1b-stochastic-simulation-vignette.html">Stochastic simulation</a> vignette. These data are not real, but imagine that they are the respective numbers of earthquakes that occur in a particular area in the years 2008 to 2017.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r">&gt; set.seed(47)
&gt; x &lt;- rpois(10, 5)
&gt; table(x)
x
 4  5  6  7  8 10 
 2  3  2  1  1  1 </pre></body></html></div>
<p>We know that these data non-negative integers. R does not know this and has included columns in the table only for non-zero frequencies, i.e. for the values 4, 5, 6, 7, 8 and 10. At the very least we might want the zero frequencies for the values 0, 1, 2, 3 and 9 to be included, and perhaps also something to indicate that there are no values greater than 10. One possibility is the following. It is not particularly elegant but it is quite effective.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r">&gt; table(c(x, 0:11)) - 1

 0  1  2  3  4  5  6  7  8  9 10 11 
 0  0  0  0  2  3  2  1  1  0  1  0 </pre></body></html></div>
<ol start="9" style="list-style-type: decimal">
<li><strong>Can you work out what this code does? It might help to look at <code><a href="https://rdrr.io/r/base/c.html">?c</a></code>.</strong></li>
</ol>
<p>If we are really fussy then we could change the name of the final heading in the table.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r">&gt; tab &lt;- table(c(x, 0:11)) - 1
&gt; names(tab)[12] &lt;- "&gt;10"
&gt; tab
  0   1   2   3   4   5   6   7   8   9  10 &gt;10 
  0   0   0   0   2   3   2   1   1   0   1   0 </pre></body></html></div>
<p>To explore another option we return to the variable <code>shuttle$damaged</code>. R has a system by which R objects are categorized into different <em>classes</em>. The effect of a given R function may depend on the class of the object provided to that function. The function <code>class</code> can be used to find out what class an object has.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r">&gt; class(shuttle$damaged)
[1] "integer"</pre></body></html></div>
<p>R thinks (correctly) that <code>shuttle$damaged</code> is an integer variable. Unfortunately, as far as I am aware, there is no mechanism for us to tell R that this integer variable can take only the values 0, 1, 2, 3, 4, 5, or 6. However, there is a way to do this if we get R to treat <code>shuttle$damaged</code> as a <em>categorical</em> variable. Then we can provide to R information about the possible <em>levels</em> of the categorical variable <code>shuttle$damaged</code>. In R categorical variables are called <em>factors</em>. We use the function <code>factor</code> to create a new variable <code>fac_dam</code> that is (a) a factor, and (b) has levels 0, 1, 2, 3, 4, 5 and 6.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r">&gt; fac_dam &lt;- factor(shuttle$damaged, levels = 0:6)
&gt; class(fac_dam)
[1] "factor"</pre></body></html></div>
<p>Now when we use <code>table</code> the output reflects automatically the possible values of the variable.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r">&gt; O_tab_fac &lt;- table(fac_dam)
&gt; O_tab_fac
fac_dam
 0  1  2  3  4  5  6 
16  5  1  1  0  0  0 </pre></body></html></div>
</div>
<div id="bar-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#bar-plot" class="anchor"></a>Bar plot</h3>
<p>The following code reproduces the graphs in Figure 2.8 of the notes.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r">&gt; par(mfrow=c(2,2))
&gt; par(oma=c(0,0,0,0),mar=c(4,4,1,2)+0.1)
&gt; xlab &lt;- "number of damaged O-rings"
&gt; ylab &lt;- "frequency"
&gt; barplot(O_tab, xlab = xlab, ylab = ylab, las = 1)
&gt; barplot(O_tab, space = 1, xlab = xlab, ylab = ylab, las = 1)
&gt; barplot(O_tab, space = 1, xlab = xlab, ylab = ylab, las = 1)
&gt; abline(h=0)
&gt; yy &lt;- as.numeric(O_tab)
&gt; xx &lt;- as.numeric(unlist(dimnames(O_tab),use.names=F))
&gt; plot(xx, yy, pch = c("0","1","2","3"), axes = FALSE, xlab ="", ylab = ylab, ylim = c(0, 16))
&gt; title(xlab="number of damaged o-rings",line=0.25)
&gt; axis(2, lty = 1, at = yy, labels = yy, pos = -0.3, las = 1)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-22-1.png" width="624"></p>
<p>If instead we use the <code>O-tab_fac</code> then the zero frequencies for values 4, 5 and 6 are included in the plot.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r">&gt; barplot(O_tab_fac, xlab = xlab, ylab = ylab, las = 1)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-23-1.png" width="624"></p>
</div>
</div>
<div id="blood-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#blood-groups" class="anchor"></a>Blood groups</h2>
<p>The data in Table 2.8 of the notes are available in the data frame <code>blood_types</code>.</p>
<div id="bar-plot-1" class="section level3">
<h3 class="hasAnchor">
<a href="#bar-plot-1" class="anchor"></a>Bar plot</h3>
<p>This code produces the bar plot on the left side of Figure 2.9.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r">&gt; blood_types
  ABO  Rh percentage
1   O Rh+         37
2   A Rh+         35
3   B Rh+          8
4  AB Rh+          3
5   O Rh-          7
6   A Rh-          7
7   B Rh-          2
8  AB Rh-          1
&gt; lab &lt;- paste(blood_types$ABO, substr(blood_types$Rh, 3, 3), sep = "")
&gt; barplot(blood_types$percentage, space = 1, xlab = "blood group", ylab = "percentage", las = 1, names.arg = lab)
&gt; abline(h=0)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-24-1.png" width="624"></p>
</div>
<div id="pie-chart" class="section level3">
<h3 class="hasAnchor">
<a href="#pie-chart" class="anchor"></a>Pie chart</h3>
<p>If you have a desperate need to produce a pie chart then you can do this using the following code.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r">&gt; par(mar = c(1, 1, 0, 1))
&gt; slices &lt;- rep(c("white","grey66","grey33","black"), 2)
&gt; pie(blood_types$percentage, labels = lab, col = slices)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-25-1.png" width="288"></p>
<p>Then read the text in the <strong>Note</strong> section at <code><a href="https://rdrr.io/r/graphics/pie.html">?pie</a></code> and forget that the function <code>pie</code> exists.</p>
</div>
</div>
<div id="ftse100-data" class="section level2">
<h2 class="hasAnchor">
<a href="#ftse100-data" class="anchor"></a>FTSE100 data</h2>
<p>The FTSE 100 share index data described in Section 2.5.6 of the notes are available in the data frame <code>ftse</code>.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r">&gt; head(ftse)
           date  price
1220 1984-04-02 1096.3
1219 1984-04-09 1129.1
1218 1984-04-16 1116.2
1217 1984-04-23 1130.9
1216 1984-04-30 1134.7
1215 1984-05-08 1076.1
&gt; tail(ftse)
        date  price
6 2007-07-09 6716.7
5 2007-07-16 6585.2
4 2007-07-23 6215.2
3 2007-07-30 6224.3
2 2007-08-06 6038.3
1 2007-08-13 6143.5</pre></body></html></div>
<p>Handling dates in R can be tricky. The main issue is to ensure that a time series, and its dates, are stored correctly. One way to achieve this is to use the function <code>ts</code> to create a time series object, specifying the frequency of the data (<code>frequency = 52</code> means weekly because there are, approximately, 52 weeks in a year) and the start data (the 14th week of 1984). This time series object is a the vector of weekly closing prices and two <em>attributes</em> in which the important extra information (metadata) of <code>tsp</code> and <code>class</code> is stored. The attribute <code>tsp</code> contains the start date, end date and frequency of the observations and the attribute <code>class</code> indicates that this is a <code>ts</code> (time series) object.</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r">&gt; ftse_ts &lt;- ts(ftse$price, frequency = 52, start = c(1984, 14))
&gt; head(ftse_ts)
[1] 1096.3 1129.1 1116.2 1130.9 1134.7 1076.1
&gt; attributes(ftse_ts)
$tsp
[1] 1984.250 2007.692   52.000

$class
[1] "ts"</pre></body></html></div>
<div id="time-series-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#time-series-plot" class="anchor"></a>Time series plot</h3>
<p>The following code produces the time series plot on the left side of Figure 2.10. Here we have used the function <code>as.Date</code> to ensure that R knows that the data to be plotted on the horizontal axis of the plot are dates. In a moment we will make use of the time series object <code>ftse_ts</code>.</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r">&gt; plot(as.Date(ftse$date), ftse$price, type = "l", ylab = "weekly FTSE 100 share index", xlab = "year")</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-28-1.png" width="624"></p>
<p>The following code produces the plot on the right side of Figure 2.10. The class of <code>ftse_ts</code> is <code>"ts"</code> so R knows that when we use <code><a href="https://rdrr.io/r/base/plot.html">plot(ftse_ts)</a></code> we want a time series plot. The rest of the code just adjusts the appearance of the plot.</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r">&gt; plot(ftse_ts, ylab = "FTSE 100 (in 1000s)", xlab = "year", las = 1, axes = FALSE)
&gt; q2 &lt;- c(min(ftse_ts), (2:6) * 1000, max(ftse_ts))
&gt; axis(2, at = q2, labels = round(q2 / 1000, 1), las = 1)
&gt; axis(4, at= q2, labels = round(q2 / 1000, 1), las=1)
&gt; axis(1)
&gt; abline(h = par("usr")[3])</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-29-1.png" width="624"></p>
<ol start="10" style="list-style-type: decimal">
<li><strong>Can you work out what each bit of the code does?</strong></li>
</ol>
</div>
</div>
<div id="influenza-data" class="section level2">
<h2 class="hasAnchor">
<a href="#influenza-data" class="anchor"></a>Influenza data</h2>
<p>The mystery data plotted in Figure 2.11 of the notes are the numbers of people in the UK visiting their doctor with symptoms of influenza (’flu) during four-weekly time periods over the time period 28th January 1967 to 13th November 2004. [I hope that this doesn’t spoil the surprise for you.]</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r">&gt; head(flu)
        date visits
1 1967-01-28   91.5
2 1967-02-25   86.8
3 1967-03-25   62.1
4 1967-04-22   63.0
5 1967-05-20   57.7
6 1967-06-17   53.7
&gt; tail(flu)
          date visits
489 2004-06-26   4.35
490 2004-07-24   2.76
491 2004-08-21   6.36
492 2004-09-18   9.71
493 2004-10-16  12.28
494 2004-11-13  18.99</pre></body></html></div>
<div id="time-series-plot-1" class="section level3">
<h3 class="hasAnchor">
<a href="#time-series-plot-1" class="anchor"></a>Time series plot</h3>
<p>We create a time series object using <code>ts</code> and produce the plot in Figure 2.11</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r">&gt; par(mar = c(5, 5, 4, 3) + 0.1, cex.axis = 0.8, cex.lab = 0.75)
&gt; flu_ts &lt;- ts(flu[,2], frequency = 13, start = c(1967, 4))
&gt; plot(flu_ts, ylab="number of 'flu consultations (in 1000s)", xlab = "year", las = 1, axes=FALSE)
&gt; q2 &lt;- c(min(flu_ts),(1:6) * 100, max(flu_ts))
&gt; axis(2, at = q2, labels = round(q2, 1), las = 1)
&gt; axis(4, at = q2, labels = round(q2, 1), las = 1)
&gt; abline(h=0)
&gt; axis(1,pos=-1)</pre></body></html></div>
<p><img src="stat0002-ch2b-graphs-vignette_files/figure-html/unnamed-chunk-31-1.png" width="624"></p>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
