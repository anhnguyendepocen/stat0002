<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 5: binomial, geometric and Poisson distributions â€¢ stat0002</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 5: binomial, geometric and Poisson distributions">
<meta property="og:description" content="stat0002">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stat0002</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/stat0002-ch1a-shuttle-vignette.html">Chapter 1: The Challenger Space Shuttle Disaster</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch1b-stochastic-simulation-vignette.html">Chapter 1: Stochastic Simulation</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2a-descriptive-statistics-vignette.html">Chapter 2: Descriptive Statistics</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2b-graphs-vignette.html">Chapter 2: Graphs (One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2c-graphs-vignette.html">Chapter 2: Graphs (More Than One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch2d-box-cox-transformation-vignette.html">Chapter 2: Transformation Of Variable</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5a-discrete-random-variables-vignette.html">Chapter 5: binomial, geometric and Poisson distributions</a>
    </li>
    <li>
      <a href="../articles/stat0002-ch5b-continous-random-variables-vignette.html">Chapter 5: uniform, exponential and normal distributions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/stat0002/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="stat0002-ch5a-discrete-random-variables-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 5: binomial, geometric and Poisson distributions</h1>
                        <h4 class="author">Paul Northrop</h4>
            
            <h4 class="date">2020-10-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/stat0002/blob/master/vignettes/stat0002-ch5a-discrete-random-variables-vignette.Rmd"><code>vignettes/stat0002-ch5a-discrete-random-variables-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>stat0002-ch5a-discrete-random-variables-vignette.Rmd</code></div>

    </div>

    
    
<p>The purposes of this vignette are to direct you to R functions relating to the <strong>discrete</strong> probability distributions considered in Chapter 5 of the STAT0002 notes and to provide code to do some of the things that appear in the lecture slides. First, we do this using the standard R functions (in the <strong>stats</strong> package). Then we repeat some of the calculations using the <strong>distributions3</strong> package <span class="citation">(Hayes and Moller-Trane 2019)</span>, which provides a neat way to work with random variables in R.</p>
<p>We illustrate these functions using the Australian birth times data, which are available in the data frame <code>aussie_births</code>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">&gt; library(stat0002)
Loading required package: rpanel
Loading required package: tcltk
Package `rpanel', version 1.1-4: type help(rpanel) for summary information
&gt; head(aussie_births)
  time  sex weight
1    5 girl   3837
2   64 girl   3334
3   78  boy   3554
4  115  boy   3838
5  177  boy   3625
6  245 girl   2208</pre></body></html></div>
<p>The <strong>stats</strong> package contains functions to evaluate the probability mass function (p.m.f.), cumulative distribution function (c.d.f.) and quantile function (which could also be called the inverse c.d.f.) of many discrete probability distributions, including the binomial, geometric and Poisson. It also contains functions to simulate random variates from these distributions. For a general description of these functions use <code><a href="https://rdrr.io/r/stats/Distributions.html">?Distributions</a></code>. These functions are named in the following way, where <code>xxx</code> is the name (perhaps abbreviated) of the distribution in question: <code>dxxx</code> (p.m.f), <code>pxxx</code> (c.d.f), <code>qxxx</code> (quantile function) and <code>rxxx</code> (random variate generation).</p>
<div id="the-binomial-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#the-binomial-distribution" class="anchor"></a>The binomial distribution</h2>
<p>Following the STAT0002 notes, let us suppose that (before we observe the data) the number <span class="math inline">\(Y\)</span> of boy babies is a random variable with a binomial(44, <span class="math inline">\(p\)</span>) distribution, where <span class="math inline">\(p\)</span> is the probability that a randomly chosen birth produces a boy. We use the data to estimate <span class="math inline">\(p\)</span>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">&gt; nboys &lt;- sum(aussie_births[, "sex"] == "boy")
&gt; ngirls &lt;- sum(aussie_births[, "sex"] == "girl")
&gt; phat &lt;- nboys / (nboys + ngirls)
&gt; phat
[1] 0.5909091</pre></body></html></div>
<p>The function <code>dbinom</code> evaluates the p.m.f. of a binomial distribution. See <code><a href="https://rdrr.io/r/stats/Binomial.html">?Binomial</a></code> for information about this function and <code>pbinom</code>, <code>qbinom</code> and <code>rbinom</code>. The following code produces a plot that is similar to the ones we looked at in a lecture. You could vary <code>p</code>, perhaps setting it to be equal to <code>phat</code>, and see the effect on the p.m.f. of the binomial distribution.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">&gt; # Plot the binomial(44, 1/2) p.m.f. 
&gt; n &lt;- nboys + ngirls
&gt; p &lt;- 1 / 2
&gt; y &lt;- 0:n
&gt; # Note that dbinom calculates the probabilities all values in the vector y
&gt; plot(y, dbinom(y, n, p), type = "h", lwd = 3, ylab = "P(Y = y)", xlab = "y")</pre></body></html></div>
<p><img src="stat0002-ch5a-discrete-random-variables-vignette_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p>For the purposes of illustrating how the functions <code>pbinom</code>, <code>qbinom</code> and <code>rbinom</code> work, let us suppose that <span class="math inline">\(p = 1/2\)</span>. We used the values of the following probabilities during a lecture, when we considered how surprised we might to observe a number of boys 4 or more from the expected value of 22 under the hypothesis that <span class="math inline">\(p = 1/2\)</span>.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r">&gt; # Calculate P(Y &gt;= 26) = P(Y &gt; 25) and P(Y &lt;= 18)
&gt; pbinom(25, size = n, prob = 1 / 2, lower.tail = FALSE)
[1] 0.1456076
&gt; pbinom(18, n, 1 / 2)
[1] 0.1456076</pre></body></html></div>
<p>Suppose that we want to find the median of <span class="math inline">\(Y\)</span>. We can use <code>qbinom</code>:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r">&gt; qbinom(1 / 2, n, 1 / 2)
[1] 22
&gt; # A check (look at the definition of the median in the notes)
&gt; pbinom(21:23, n, 1 / 2)
[1] 0.4401979 0.5598021 0.6742061</pre></body></html></div>
<p>The following code simulates 100 values from a Binomial(44, 1/2) distribution.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">&gt; ysim &lt;- rbinom(100, 44, 1 / 2)
&gt; ysim
  [1] 22 26 22 18 22 30 24 24 20 21 18 21 22 24 19 20 26 22 24 17 23 20 16 24 26
 [26] 24 17 24 25 18 20 18 24 24 24 27 19 22 18 21 20 25 26 22 21 25 22 25 23 22
 [51] 21 22 26 23 21 28 20 23 22 23 26 23 22 22 19 23 23 19 27 23 27 21 24 21 22
 [76] 25 18 22 23 23 20 24 24 28 21 21 21 25 25 23 21 24 23 30 28 19 26 28 20 21
&gt; summary(ysim)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  16.00   21.00   22.50   22.61   24.00   30.00 </pre></body></html></div>
<div id="the-distributions3-package" class="section level3">
<h3 class="hasAnchor">
<a href="#the-distributions3-package" class="anchor"></a>The distributions3 package</h3>
<p>In September 2019 the <strong>distributions3</strong> package <span class="citation">(Hayes and Moller-Trane 2019)</span> was released. A neat feature of this package is that it enables us to create an R object that corresponds to a particular random variable. Then we are able easily to use some simple R functions to perform calculations with this random variable. The way that this works is perhaps more intuitive than the way in which we use functions like <code><a href="https://rdrr.io/r/stats/Binomial.html">dbinom()</a></code> above.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">&gt; library(distributions3)

Attaching package: 'distributions3'
The following objects are masked from 'package:stats':

    Gamma, quantile
The following object is masked from 'package:grDevices':

    pdf
&gt; # (The warnings tell us that the distributions3 package has functions with the
&gt; # same names as functions from other packages and has `masked' them, that is,
&gt; # R will use these functions from distributions3, not the other functions.)
&gt; #
&gt; # Create an R object that is, effectively, a binomial(n, 1/2) random variable
&gt; Y &lt;- Binomial(n, 1 / 2)
&gt; Y
Binomial distribution (size = 44, p = 0.5)</pre></body></html></div>
<p>We reproduce the plot and repeat the calculation of the probabilities.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">&gt; # Reproduce the plot.  
&gt; plot(0:n, pmf(Y, 0:n), type = "h", lwd = 3, ylab = "P(X = x)", xlab = "x")</pre></body></html></div>
<p><img src="stat0002-ch5a-discrete-random-variables-vignette_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><html><body><pre class="r">&gt; 1 - cdf(Y, 25)
[1] 0.1456076
&gt; cdf(Y, 18)
[1] 0.1456076</pre></body></html></div>
<p>Now we use the <strong>distributions</strong> package to performs some of the calculations that were involved in producing the lecture slides associated with the geometric and Poisson distributions.</p>
</div>
</div>
<div id="the-geometric-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#the-geometric-distribution" class="anchor"></a>The geometric distribution</h2>
<p>We recreate the table in the lecture slides, of the observed frequencies and proportions and the corresponding estimated expected values under a geometric distribution fitted to the data.</p>
<p>Râ€™s <code>dgeom</code> function, and the function <code>Geometric</code> in the <strong>distributions</strong> package, are is based on the number of failures before the first success, not the number of trials. Therefore, we subtract 1 below when we call the function <code>dgeom</code>.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">&gt; # Observed, adding a zero for greater than or equal to 6
&gt; geom &lt;- diff(c(0, which(aussie_births$sex == "boy")))
&gt; max_w &lt;- max(geom)
&gt; geom &lt;- c(1:(max_w + 1), geom)
&gt; obs_freq &lt;- table(geom) - 1
&gt; obs_prop &lt;- obs_freq / sum(obs_freq)
&gt; round(obs_prop, 3)
geom
    1     2     3     4     5     6 
0.692 0.115 0.154 0.000 0.038 0.000 
&gt; 
&gt; # Estimated expected, using dgeom
&gt; est_prob &lt;- dgeom((1:max_w) - 1, prob = phat)
&gt; est_prob &lt;- c(est_prob, 1 - sum(est_prob))
&gt; exp_freq &lt;- nboys * est_prob
&gt; 
&gt; # The table
&gt; round(cbind(w = 1:(max_w + 1), obs_freq, exp_freq, obs_prop, est_prob), 3)
  w obs_freq exp_freq obs_prop est_prob
1 1       18   15.364    0.692    0.591
2 2        3    6.285    0.115    0.242
3 3        4    2.571    0.154    0.099
4 4        0    1.052    0.000    0.040
5 5        1    0.430    0.038    0.017
6 6        0    0.298    0.000    0.011</pre></body></html></div>
<p>Alternatively, We could also use the <strong>distributions3</strong> package to calculate the probabilities that we require.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">&gt; W &lt;- Geometric(phat)
&gt; W
Geometric distribution (p = 0.590909090909091)
&gt; # P(W = w), for w = 1, ..., 5 (note the -1)
&gt; pmf(W, 1:5 - 1)
[1] 0.59090909 0.24173554 0.09889181 0.04045574 0.01655008
&gt; # P(W &gt;= 6) = 1 - P(W &lt; 6) = 1 - P(W &lt;= 5)
&gt; 1 - cdf(W, 5 - 1)
[1] 0.01145774</pre></body></html></div>
</div>
<div id="the-poisson-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#the-poisson-distribution" class="anchor"></a>The Poisson distribution</h2>
<p>Here we use the <strong>distributions</strong> package to produce a plot of the p.m.f. of the Poisson(<span class="math inline">\(\hat{\lambda}\)</span>) distribution, where <span class="math inline">\(\hat{\lambda}\)</span> is equal to the sample mean of the numbers of babies born in each of the 24 hourly periods. We also calculate the probabilities involved in the table of observed and estimated expected frequencies given in the lecture.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">&gt; lambdahat &lt;- 44 / 24
&gt; N &lt;- Poisson(lambdahat)
&gt; N
Poisson distribution (lambda = 1.83333333333333)</pre></body></html></div>
<div class="sourceCode" id="cb13"><html><body><pre class="r">&gt; plot(0:10, pmf(N, 0:10), type = "h", lwd = 3, ylab = "P(N = n)", xlab = "n")</pre></body></html></div>
<p><img src="stat0002-ch5a-discrete-random-variables-vignette_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><html><body><pre class="r">&gt; 
&gt; pmf(N, 0:4)
[1] 0.15987975 0.29311287 0.26868680 0.16419749 0.07525718
&gt; # P(N &gt;= 5)
&gt; 1 - cdf(N, 4)
[1] 0.03886592</pre></body></html></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script><div id="refs" class="references">
<div id="ref-distributions3">
<p>Hayes, A., and R. Moller-Trane. 2019. <em>distributions3: Probability Distributions as S3 Objects</em>. <a href="https://github.com/alexpghayes/distributions3">https://github.com/alexpghayes/distributions3</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
